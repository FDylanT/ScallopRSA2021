---
title: "OctCruiseChemistry"
author: "Dylan Titmuss"
date: "3/15/2022"
output: html_document
editor_options: 
  chunk_output_type: console
---

This script visualizes the chemistry data from the October RSA cruise.
Run chunks 1-7 of `Chemistry_Oct.Rmd` to load data.

## Load packages
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, root.dir = "~/Desktop/Repos/ScallopRSA2021")

library(tidyverse)
```

# Prop-prop plots

## Temp vs Sal, coloured cast
```{r}
#plot <-
ggplot(oct, aes(x = Salinity, y = Temp, shape = Cast, col = Cast)) +
  geom_point() +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  xlab("Salinity (PSU)") +
  ylab("Temperature (°C)") +
  theme_bw() +
  geom_label(aes(x = 35.255, y = 20.1, label = "October"), size = 5, color = "black",
             fontface = "bold", label.size = 0.75, label.padding = unit(0.5, "lines"))
```

## DIC vs Sal, coloured cast
```{r}
ggplot(oct, aes(x = Salinity, y = DIC, shape = Cast, col = Cast)) +
  geom_point() +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()

#plot(DIC ~ Salinity, data = oct, col = factor(Cast))
#identify(oct$DIC ~ oct$Salinity)
```

## TA vs Sal, coloured cast
```{r}
ggplot(oct, aes(x = Salinity, y = TA, shape = Cast, col = Cast)) +
  geom_point() +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()

#plot(TA ~ Salinity, data = oct, col = factor(Cast))
#abline(lm(oct$TA ~ oct$Salinity))
#identify(oct$TA ~ oct$Salinity)

### check 096, 098, 100 bottom TA + sal
```

## TA vs DIC, coloured cast
```{r}
ggplot(oct, aes(x = DIC, y = TA, shape = Cast, col = Cast)) +
  geom_point() +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()

#plot(oct$TA ~ oct$DIC, col = factor(oct$Cast))
#identify(oct$TA ~ oct$DIC)
```

## DIC vs density, coloured cast
```{r}
ggplot(oct, aes(x = Density, y = DIC, shape = Cast, col = Cast)) +
  geom_point() +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()
```

## TA vs density, coloured cast
```{r}
ggplot(oct, aes(x = Density, y = TA, shape = Cast, col = Cast)) +
  geom_point() +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()
```

## Connect surface & bottom points with lines
```{r}
ggplot(oct, aes(x = Density, y = TA, shape = Cast, col = Cast, group = Station)) +
  geom_point() +
  geom_line(col = "grey56", linetype = "dotted") +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()

ggplot(oct, aes(x = Salinity, y = DIC, shape = Cast, col = Cast, group = Station)) +
  geom_point() +
  geom_line(col = "grey56", linetype = "dotted") +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()

ggplot(oct, aes(x = Density, y = DIC, shape = Cast, col = Cast, group = Station)) +
  geom_point() +
  geom_line(col = "grey56", linetype = "dotted") +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()

ggplot(oct, aes(x = Salinity, y = TA, shape = Cast, col = Cast, group = Station)) +
  geom_point() +
  geom_line(col = "grey56", linetype = "dotted") +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("darkblue", "coral2"),
                      guide = guide_legend(reverse = TRUE)) +
  theme_bw()
```






## Oct + May together
Run chunks 2-7 of `Chemistry_May.Rmd` to load May data.
```{r}
# Temp vs Sal, coloured season
ggplot() +
  geom_point(data = may, aes(x = Salinity, y = Temp, shape = Cast, col = "May")) +
  geom_point(data = oct, aes(x = Salinity, y = Temp, shape = Cast, col = "October")) +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("chartreuse3", "royalblue"),
                      name = "Month") +
  xlab("Salinity (PSU)") +
  ylab("Temperature (°C)") +
  theme_bw()

# DIC vs Sal, coloured season
ggplot() +
  geom_point(data = may, aes(x = Salinity, y = DIC, shape = Cast, col = "May")) +
  geom_point(data = oct, aes(x = Salinity, y = DIC, shape = Cast, col = "October")) +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("chartreuse3", "royalblue"),
                      name = "Month") +
  xlab("Salinity (PSU)") +
  ylab("DIC (umol/kg)") +
  theme_bw()

# TA vs Sal, coloured season
ggplot() +
  geom_point(data = may, aes(x = Salinity, y = TA, shape = Cast, col = "May")) +
  geom_point(data = oct, aes(x = Salinity, y = TA, shape = Cast, col = "October")) +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("chartreuse3", "royalblue"),
                      name = "Month") +
  xlab("Salinity (PSU)") +
  ylab("Total Alkalinity (umol/kg)") +
  theme_bw()

# DIC vs rho, coloured season
ggplot() +
  geom_point(data = may, aes(x = Density, y = DIC, shape = Cast, col = "May")) +
  geom_point(data = oct, aes(x = Density, y = DIC, shape = Cast, col = "October")) +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("chartreuse3", "royalblue"),
                      name = "Month") +
  xlab("Density (kg/m^3)") +
  ylab("DIC (umol/kg)") +
  theme_bw()

# TA vs rho, coloured season
ggplot() +
  geom_point(data = may, aes(x = Density, y = TA, shape = Cast, col = "May")) +
  geom_point(data = oct, aes(x = Density, y = TA, shape = Cast, col = "October")) +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("chartreuse3", "royalblue"),
                      name = "Month") +
  xlab("Density (kg/m^3)") +
  ylab("Total Alkalinity (umol/kg)") +
  theme_bw()

# TA vs DIC, coloured season
ggplot() +
  geom_point(data = may, aes(x = DIC, y = TA, shape = Cast, col = "May")) +
  geom_point(data = oct, aes(x = DIC, y = TA, shape = Cast, col = "October")) +
  scale_shape_manual(values = c(16, 1),
                     guide = guide_legend(reverse = TRUE)) +
  scale_colour_manual(values = c("chartreuse3", "royalblue"),
                      name = "Month") +
  xlab("DIC (umol/kg)") +
  ylab("Total Alkalinity (umol/kg)") +
  theme_bw()
```






## Temp v Sal, coloured by 3rd property
```{r}
#ggplot_build(plot)$layout$panel_scales_x[[1]]$range$range # [31.5991 35.6009]
#ggplot_build(plot)$layout$panel_scales_y[[1]]$range$range # [8.317186 20.698551]

# bottom, coloured depth
oct %>%
  filter(Cast == "Bottom") %>%
  ggplot(aes(x = Salinity, y = Temp, col = Depth)) +
  geom_point() +
  scale_colour_viridis(option = "mako", direction = -1) +
  scale_x_continuous(limits = c(31.59, 35.61)) +
  scale_y_continuous(limits = c(8.31, 20.70)) +
  guides(colour = guide_colourbar(reverse = TRUE)) + 
  theme_bw()

#plot(Temp ~ Salinity, data = oct)
#identify(oct$Temp ~ oct$Salinity)

# coloured DIC
ggplot(oct, aes(x = Salinity, y = Temp, col = DIC, shape = Cast)) +
  geom_point() +
  scale_colour_viridis(option = "rocket") +
  scale_shape_manual(values = c(16, 1)) +
  theme_bw()

#plot(Temp ~ Salinity, data = oct, col = factor(DIC))
#identify(oct$Temp ~ oct$Salinity)

### already checked 009 bottom DIC -- fine

# coloured TA
ggplot(oct, aes(x = Salinity, y = Temp, col = TA, shape = Cast)) +
  geom_point() +
  scale_colour_viridis(option = "mako") +
  scale_shape_manual(values = c(16, 1)) +
  theme_bw()

# coloured pH
ggplot(oct, aes(x = Salinity, y = Temp, col = pH, shape = Cast)) +
  geom_point() +
  scale_colour_viridis(name = "pH") +
  scale_shape_manual(values = c(16, 1)) +
  theme_bw()

# coloured OmegaAragonite
ggplot(oct, aes(x = Salinity, y = Temp, col = OmegaAragonite, shape = Cast)) +
  geom_point() +
  scale_colour_viridis(name = "OmegaAragonite") +
  scale_shape_manual(values = c(16, 1)) +
  theme_bw()

# coloured density
ggplot(oct, aes(x = Salinity, y = Temp, col = Density, shape = Cast)) +
  geom_point() +
  scale_colour_viridis(name = "Density") +
  scale_shape_manual(values = c(16, 1)) +
  theme_bw()
```

