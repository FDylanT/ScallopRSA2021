knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(chron)
library(oce)
# install.packages("RSQLite")
# install.packages("DBI")
setwd("~/Repos/ScallopRSA2021")
## No data from sites 006, 012, 016, 022, 030, 081, 111, 114 ##
# Chronological sites 001-060; includes 001-057 + 060-062 + 066-068 (no data from sites 006, 012, 016, 022, 030)
may1rsk <- read.rsk("./data/CTD_raw/RSA_20210504_060.rsk")
may1 <- as.ctd(may1rsk)
write.ctd(may1, "data/may1.csv")
may1 <- read.csv("may1.csv") %>%
slice(-c(1:17)) %>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.18.54.48.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.18.54.48.UTC)
# Chronological sites 065-113; includes 058-059 + 063-065 + 069-113 (no data from sites 081, 111)
may2rsk <- read.rsk("./data/CTD_raw/RSA_20210506_113.rsk")
may2 <- as.ctd(may2rsk)
write.ctd(may2, "data/may2.csv")
may2 <- read.csv("may2.csv") %>%
slice(-c(1:17)) %>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.18.54.56.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.18.54.56.UTC)
# No data from site 114
may_combined <- rbind(may1, may2)
write.csv(may_combined, "./data/CTD_allMay.csv", row.names = FALSE)
View(may1)
may1 <- read.csv("may1.csv") %>%
slice(-c(1:17)) #%>%
## No data from sites 006, 012, 016, 022, 030, 081, 111, 114 ##
# Chronological sites 001-060; includes 001-057 + 060-062 + 066-068 (no data from sites 006, 012, 016, 022, 030)
may1rsk <- read.rsk("./data/CTD_raw/RSA_20210504_060.rsk")
may1 <- as.ctd(may1rsk)
write.ctd(may1, "data/may1.csv")
may1 <- read.csv("may1.csv") %>%
slice(-c(1:17)) #%>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.18.54.48.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.18.54.48.UTC)
# Chronological sites 065-113; includes 058-059 + 063-065 + 069-113 (no data from sites 081, 111)
may2rsk <- read.rsk("./data/CTD_raw/RSA_20210506_113.rsk")
may2 <- as.ctd(may2rsk)
write.ctd(may2, "data/may2.csv")
may2 <- read.csv("may2.csv") %>%
slice(-c(1:17)) #%>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.18.54.56.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.18.54.56.UTC)
# No data from site 114
may_combined <- rbind(may1, may2)
write.csv(may_combined, "./data/CTD_allMay.csv", row.names = FALSE)
# Chronological sites 001-060; includes 001-057 + 060-062 + 066-068 (no data from sites 006, 012, 016, 022, 030)
may1rsk <- read.rsk("./data/CTD_raw/RSA_20210504_060.rsk")
may1 <- as.ctd(may1rsk)
write.ctd(may1, "data/may1.csv")
# Chronological sites 001-060; includes 001-057 + 060-062 + 066-068 (no data from sites 006, 012, 016, 022, 030)
may1rsk <- read.rsk("data/CTD_raw/RSA_20210504_060.rsk")
## No data from sites 006, 012, 016, 022, 030, 081, 111, 114 ##
# Chronological sites 001-060; includes 001-057 + 060-062 + 066-068 (no data from sites 006, 012, 016, 022, 030)
may1rsk <- read.rsk("data/CTD_raw/RSA_20210504_060.rsk")
may1 <- as.ctd(may1rsk)
write.ctd(may1, "data/may1.csv")
may1 <- read.csv("data/may1.csv") %>%
slice(-c(1:17)) #%>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.18.54.48.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.18.54.48.UTC)
# Chronological sites 065-113; includes 058-059 + 063-065 + 069-113 (no data from sites 081, 111)
may2rsk <- read.rsk("data/CTD_raw/RSA_20210506_113.rsk")
may2 <- as.ctd(may2rsk)
write.ctd(may2, "data/may2.csv")
may2 <- read.csv("data/may2.csv") %>%
slice(-c(1:17)) #%>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.18.54.56.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.18.54.56.UTC)
# No data from site 114
may_combined <- rbind(may1, may2)
write.csv(may_combined, "data/CTD_allMay.csv", row.names = FALSE)
View(may1)
View(may2)
may1 <- read.csv("data/may1.csv") %>%
slice(-c(1:17)) %>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.20.39.34.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.20.39.34.UTC)
may2 <- read.csv("data/may2.csv") %>%
slice(-c(1:17)) %>%
mutate(data = R.oce.file.exported.at.time.2021.11.08.20.39.44.UTC) %>%
select(-R.oce.file.exported.at.time.2021.11.08.20.39.44.UTC)
may_combined <- rbind(may1, may2)
write.csv(may_combined, "data/CTD_allMay.csv", row.names = FALSE)
mayCTD <- read.csv("data/CTD_raw/CTD_allMay.csv")
time <- mayCTD %>%
slice(which(row_number() %% 9 == 1))
conductivity <- mayCTD %>%
slice(which(row_number() %% 9 == 2))
temperature <- mayCTD %>%
slice(which(row_number() %% 9 == 3))
pressure <- as.data.frame(c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]])) %>%
mutate(data = `c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]])`)
View(may1rsk)
View(may2rsk)
may2rsk@data[["pressure"]]
pressure <- as.data.frame(c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]])) #%>%
View(pressure)
pressure <- as.data.frame(c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]]), colnames("data")) #%>%
pressure <- as.data.frame(c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]]),
colnames(pressure) <- "data") #%>%
pressure <- as.data.frame(c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]]),
col.names(pressure) <- "data") #%>%
pressure <- as.data.frame("data" = c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]])) #%>%
?as.data.frame
pressure <- as.data.frame(c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]]), col.names = "data") #%>%
pressure <- data.frame("data" = c(may1rsk@data[["pressure"]],
may2rsk@data[["pressure"]])) #%>%
optode_temp <- mayCTD %>%
slice(which(row_number() %% 9 == 5))
dissolvedO2conc <- mayCTD %>%
slice(which(row_number() %% 9 == 6))
sea_pressure <- mayCTD %>%
slice(which(row_number() %% 9 == 7))
depth <- mayCTD %>%
slice(which(row_number() %% 9 == 8))
salinity <- mayCTD %>%
slice(which(row_number() %% 9 == 0))
# Combine channels into dataframe
mayCTD <- time %>%
mutate(Time = data,
Conductivity_mS.cm = conductivity$data,
Temperature_degC = temperature$data,
Pressure_dbar = pressure$data,
OptodeTemp_degC = optode_temp$data,
DissolvedO2Conc_umol.l = dissolvedO2conc$data,
SeaPressure_dbar = sea_pressure$data,
Depth_m = depth$data,
Salinity_PSU = salinity$data) %>%
select(-data) %>%
separate(Time, c("Date", "Time"), " ") %>%
mutate(Date = as.Date(Date, format = "%Y-%m-%d"))
write.csv(mayCTD, "data/CTD_raw/CTD_allMay.csv", row.names = FALSE)
# Combine channels into dataframe
mayCTD <- time %>%
mutate(Time = data,
Conductivity_mS.cm = conductivity$data,
Temperature_degC = temperature$data,
Pressure_dbar = pressure$data,
OptodeTemp_degC = optode_temp$data,
DissolvedO2Conc_umol.l = dissolvedO2conc$data,
SeaPressure_dbar = sea_pressure$data,
Depth_m = depth$data,
Salinity_PSU = salinity$data) %>%
select(-data) %>%
separate(Time, c("Date", "Time"), " ") %>%
mutate(Date = as.Date(Date, format = "%Y-%m-%d")) %>%
filter(Data >= "2021-05-02")
# Combine channels into dataframe
mayCTD <- time %>%
mutate(Time = data,
Conductivity_mS.cm = conductivity$data,
Temperature_degC = temperature$data,
Pressure_dbar = pressure$data,
OptodeTemp_degC = optode_temp$data,
DissolvedO2Conc_umol.l = dissolvedO2conc$data,
SeaPressure_dbar = sea_pressure$data,
Depth_m = depth$data,
Salinity_PSU = salinity$data) %>%
select(-data) %>%
separate(Time, c("Date", "Time"), " ") %>%
mutate(Date = as.Date(Date, format = "%Y-%m-%d")) %>%
filter(Date >= "2021-05-02")
write.csv(mayCTD, "data/CTD_raw/CTD_allMay.csv", row.names = FALSE)
oct1.2 <- read.csv("data/CTD_raw/RSA_20211006_021.csv", skip = 1, header = TRUE) %>%
separate(Time, c("Date", "Time"), " ") #%>%
str(oct1.2)
View(oct1.2)
oct1.2 <- read.csv("data/CTD_raw/RSA_20211006_021.csv", skip = 1, header = TRUE) %>%
separate(Time, c("Date", "Time"), " ") %>%
mutate(Date = as.Date(Date, format = "%Y-%m-%d")) %>%
filter(Date >= "2021-10-05")
# Sites 001-021
oct1 <- read.csv("data/CTD_raw/RSA_20211006_021.csv", skip = 1, header = TRUE) %>%
slice(-c(1:2)) %>% #remove test runs in the lab
separate(Time, c("Date", "Time"), " ")
# Chronological sites 024-064; includes 024-068
oct2 <- read.csv("data/CTD_raw/RSA_20211008_064.csv", skip = 1, header = TRUE) %>%
separate(Time, c("Date", "Time"), " ")
# Sites 069-114 (no data from site 104)
oct3 <- read.csv("data/CTD_raw/RSA_20211010_114.csv", skip = 1, header = TRUE) %>%
separate(Time, c("Date", "Time"), " ")
oct_combined <- rbind(oct1, oct2, oct3)
write.csv(oct_combined, "data/CTD_raw/CTD_allOct.csv", row.names = FALSE)
may1rsk@data[["time"]]
mayCTD <- read.csv("data/CTD_raw/CTD_allMay.csv")
octCTD <- read.csv("data/CTD_raw/CTD_allOct.csv")
View(octCTD)
